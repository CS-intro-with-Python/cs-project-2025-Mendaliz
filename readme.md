# üç≥ **CookBook** - –ü—Ä–æ—Å—Ç–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–µ—Ü–µ–ø—Ç–æ–≤

## üìã –û–ø–∏—Å–∞–Ω–∏–µ
–ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ—Ü–µ–ø—Ç–æ–≤. –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
1. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç–µ —Ä–µ—Ü–µ–ø—Ç –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ (—Å—Å—ã–ª–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)
2. –î–æ–±–∞–≤–ª—è–µ—Ç–µ –∑–∞–º–µ—Ç–∫–∏ –∫ –Ω–µ–º—É –ø–æ—Å–ª–µ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è
3. –ö–æ–≥–¥–∞ –∑–∞–º–µ—Ç–æ–∫ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ - —Å–æ–∑–¥–∞–µ—Ç–µ "–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—É—é" –≤–µ—Ä—Å–∏—é —Ä–µ—Ü–µ–ø—Ç–∞

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
**POST** `/api/auth/register`
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```
–û—Ç–≤–µ—Ç:
```json
{
  "message": "User created",
  "user_id": 1
}
```

### –í—Ö–æ–¥
**POST** `/api/auth/login`
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```
–û—Ç–≤–µ—Ç:
```json
{
  "access_token": "jwt_token_here",
  "user_id": 1
}
```

## üìñ –†–µ—Ü–µ–ø—Ç—ã

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã
**GET** `/api/recipes`
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `tag` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `type` - `saved` –∏–ª–∏ `verified` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û—Ç–≤–µ—Ç:
```json
{
  "recipes": [
    {
      "id": 1,
      "title": "–°—ã—Ä–Ω–∏–∫–∏",
      "type": "saved", // –∏–ª–∏ "verified"
      "tags": ["–∑–∞–≤—Ç—Ä–∞–∫", "—Ç–≤–æ—Ä–æ–≥"],
      "notes_count": 3
    }
  ]
}
```

### –°–æ–∑–¥–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç (–∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞)
**POST** `/api/recipes`
```json
{
  "title": "–°—ã—Ä–Ω–∏–∫–∏",
  "source_url": "https://example.com/recipe",
  "content": "–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã... –®–∞–≥–∏ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è...",
  "tags": ["–∑–∞–≤—Ç—Ä–∞–∫", "—Ç–≤–æ—Ä–æ–≥"]
}
```
–û—Ç–≤–µ—Ç:
```json
{
  "id": 1,
  "title": "–°—ã—Ä–Ω–∏–∫–∏",
  "type": "saved"
}
```

### –î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É –∫ —Ä–µ—Ü–µ–ø—Ç—É
**POST** `/api/recipes/{id}/notes`
```json
{
  "text": "–î–æ–±–∞–≤–∏–ª –≤–∞–Ω–∏–ª–∏–Ω, —Å—Ç–∞–ª–æ –∞—Ä–æ–º–∞—Ç–Ω–µ–µ. –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–ø—Ä–æ–±—É—é —Å –∏–∑—é–º–æ–º."
}
```
–û—Ç–≤–µ—Ç:
```json
{
  "note_id": 5,
  "recipe_id": 1,
  "notes_count": 4
}
```

### –°–æ–∑–¥–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é
**POST** `/api/recipes/{id}/verify`
(–Ω–µ —Ç—Ä–µ–±—É–µ—Ç —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–∞)

–û—Ç–≤–µ—Ç:
```json
{
  "new_recipe_id": 2,
  "original_recipe_id": 1,
  "type": "verified",
  "notes_used": 5 // —Å–∫–æ–ª—å–∫–æ –∑–∞–º–µ—Ç–æ–∫ –±—ã–ª–æ —É—á—Ç–µ–Ω–æ
}
```

### –ü–æ–ª—É—á–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç —Å –∑–∞–º–µ—Ç–∫–∞–º–∏
**GET** `/api/recipes/{id}`
–û—Ç–≤–µ—Ç:
```json
{
  "id": 1,
  "title": "–°—ã—Ä–Ω–∏–∫–∏",
  "source_url": "https://example.com/recipe",
  "content": "–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã... –®–∞–≥–∏ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è...",
  "type": "saved",
  "tags": ["–∑–∞–≤—Ç—Ä–∞–∫", "—Ç–≤–æ—Ä–æ–≥"],
  "created_at": "2024-01-15",
  "notes": [
    {
      "id": 1,
      "text": "–î–æ–±–∞–≤–∏–ª –≤–∞–Ω–∏–ª–∏–Ω",
      "created_at": "2024-01-20"
    },
    {
      "id": 2,
      "text": "–£–º–µ–Ω—å—à–∏–ª –º—É–∫—É",
      "created_at": "2024-01-25"
    }
  ]
}
```

### –£–¥–∞–ª–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç
**DELETE** `/api/recipes/{id}`

## üè∑Ô∏è –¢–µ–≥–∏

### –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏
**GET** `/api/tags`
–û—Ç–≤–µ—Ç:
```json
{
  "tags": [
    {
      "name": "–∑–∞–≤—Ç—Ä–∞–∫",
      "recipe_count": 5
    },
    {
      "name": "—Ç–≤–æ—Ä–æ–≥",
      "recipe_count": 3
    }
  ]
}
```

## üóÇÔ∏è –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

### User
```json
{
  "id": "number",
  "email": "string",
  "password_hash": "string",
  "created_at": "datetime"
}
```

### Recipe
```json
{
  "id": "number",
  "user_id": "number",
  "title": "string",
  "content": "text", // –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç —Ä–µ—Ü–µ–ø—Ç–∞
  "source_url": "string",
  "type": "saved|verified", // —Ç–∏–ø —Ä–µ—Ü–µ–ø—Ç–∞
  "original_recipe_id": "number|null", // –¥–ª—è verified: —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª
  "created_at": "datetime"
}
```

### Note
```json
{
  "id": "number",
  "recipe_id": "number",
  "text": "text",
  "created_at": "datetime"
}
```

### Tag
```json
{
  "id": "number",
  "name": "string",
  "user_id": "number"
}
```

### RecipeTag (—Å–≤—è–∑—å –º–Ω–æ–≥–∏–µ-–∫–æ-–º–Ω–æ–≥–∏–º)
```json
{
  "recipe_id": "number",
  "tag_id": "number"
}
```

## üìä –°–≤–æ–¥–∫–∞ API

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|------|----------|
| POST | `/api/auth/register` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è |
| POST | `/api/auth/login` | –í—Ö–æ–¥ |
| GET | `/api/recipes` | –°–ø–∏—Å–æ–∫ —Ä–µ—Ü–µ–ø—Ç–æ–≤ |
| POST | `/api/recipes` | –°–æ–∑–¥–∞—Ç—å —Ä–µ—Ü–µ–ø—Ç |
| GET | `/api/recipes/{id}` | –ü–æ–ª—É—á–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç |
| DELETE | `/api/recipes/{id}` | –£–¥–∞–ª–∏—Ç—å —Ä–µ—Ü–µ–ø—Ç |
| POST | `/api/recipes/{id}/notes` | –î–æ–±–∞–≤–∏—Ç—å –∑–∞–º–µ—Ç–∫—É |
| POST | `/api/recipes/{id}/verify` | –°–æ–∑–¥–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é |
| GET | `/api/tags` | –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç–µ–≥–∏ |

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ JWT —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:
```
Authorization: Bearer –≤–∞—à_—Ç–æ–∫–µ–Ω
```

### –û—à–∏–±–∫–∏
- `400` - –ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- `401` - –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
- `404` - –ù–µ –Ω–∞–π–¥–µ–Ω–æ
- `500` - –û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

### –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã:

1. **–°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ—Ü–µ–ø—Ç–∞:**
```bash
POST /api/recipes
{
  "title": "–û–º–ª–µ—Ç",
  "source_url": "https://cook.ru/omelet",
  "content": "–í–∑–±–∏—Ç—å —è–π—Ü–∞...",
  "tags": ["–∑–∞–≤—Ç—Ä–∞–∫", "—è–π—Ü–∞"]
}
```

2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–º–µ—Ç–æ–∫:**
```bash
POST /api/recipes/1/notes
{
  "text": "–î–æ–±–∞–≤–∏–ª –º–æ–ª–æ–∫–æ - —Å—Ç–∞–ª–æ –ø—ã—à–Ω–µ–µ"
}

POST /api/recipes/1/notes
{
  "text": "–ó–µ–ª–µ–Ω—ã–π –ª—É–∫ –æ—á–µ–Ω—å —É–ª—É—á—à–∞–µ—Ç –≤–∫—É—Å"
}
```

3. **–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏:**
```bash
POST /api/recipes/1/verify
```
‚Üí –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç —Å —Ç–∏–ø–æ–º `verified`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç —É–ª—É—á—à–µ–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Å–µ—Ö –∑–∞–º–µ—Ç–æ–∫

4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–µ–≥–∞–º:**
```bash
GET /api/recipes?tag=–∑–∞–≤—Ç—Ä–∞–∫&type=verified
```
‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ —Ä–µ—Ü–µ–ø—Ç—ã —Å —Ç–µ–≥–æ–º "–∑–∞–≤—Ç—Ä–∞–∫"